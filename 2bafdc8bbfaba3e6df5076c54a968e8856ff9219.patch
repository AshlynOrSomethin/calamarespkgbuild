From 2bafdc8bbfaba3e6df5076c54a968e8856ff9219 Mon Sep 17 00:00:00 2001
From: Philip Mueller <philm@manjaro.org>
Date: Mon, 4 Dec 2023 06:42:52 +0700
Subject: [PATCH] [data] add more envs for theme fix

---
 data/calamares_polkit | 15 +++++++++++----
 1 file changed, 11 insertions(+), 4 deletions(-)

diff --git a/data/calamares_polkit b/data/calamares_polkit
index b25df93af..db9e92de6 100644
--- a/data/calamares_polkit
+++ b/data/calamares_polkit
@@ -1,11 +1,18 @@
 #!/bin/bash
 if [ $(which pkexec) ]; then
 	pkexec --disable-internal-agent \
-	env DISPLAY="$DISPLAY" \
-	    XAUTHORITY="$XAUTHORITY" \
-	    DBUS_SESSION_BUS_ADDRESS="$DBUS_SESSION_BUS_ADDRESS" \
+	env DBUS_SESSION_BUS_ADDRESS="$DBUS_SESSION_BUS_ADDRESS" \
+	    DISPLAY="$DISPLAY" \
+	    GNOME_DESKTOP_SESSION_ID="GNOME_DESKTOP_SESSION_ID" \
 	    HOME="$HOME" \
-	    "/usr/bin/calamares" "-D6" "$@"
+	    KDE_FULL_SESSION="$KDE_FULL_SESSION" \
+	    KDE_SESSION_VERSION="$KDE_SESSION_VERSION" \
+            QT_STYLE_OVERRIDE="$QT_STYLE_OVERRIDE" \
+            QT_QPA_PLATFORMTHEME="$QT_QPA_PLATFORMTHEME" \
+            QT_XCB_FORCE_SOFTWARE_OPENGL="$QT_XCB_FORCE_SOFTWARE_OPENGL" \
+	    XAUTHORITY="$XAUTHORITY" \
+	    XDG_CURRENT_DESKTOP="XDG_CURRENT_DESKTOP" \ 
+	"/usr/bin/calamares" "-D6" "$@"
 else
 	/usr/bin/calamares "-D6" "$@"
 fi
-- 
GitLab

